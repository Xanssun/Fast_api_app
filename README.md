# Fast_api_app

- Стэк проекта:

1. Python
2. Fast api
3. Sqlalchemy/sqlite
5. Pydantic
4. Rabbit MQ

- Структура проекта:

1. Корневая папка:

   • Файл docker-compose.yaml
    
2. 

   • Папочка test_data содержит тестовые данные. (2 файла txt с данными)

3. Папка App хранит в себе проект на Fast api

   • Папка dto хранит в себе файл message_dto.py, в котором хранятся модели для pydantic

   • Папка models хранит в себе файл message.py, в котором хранятся модели для базы.

   • Папка rabbit хранит в себе файл server, в котором реализовано подкчючение к брокеру, механизм машрутизации.

   • Папка service хранит в себе файл bd_save.py, в котором реализован механизм сохранения данных в бд.

   • Файл database.py содержит в себе инициализацию базы данных.  SQLAlchemy как ORM, а SQLite — как база данных.

   • Файл main.py. Основной файл. В нем описана вся логика проекта. 

   • Файл requirements.txt хранит в себе зависимости.

   • Файл Dockerfile. 


# Запуск проекта

1. Cклонируйте репорзиторий.

2. Создайте .env файл c переменными RMQ_LOGIN, RMQ_PASSWORD, RMQ_HOST, RMQ_PORT, EXCHANGE_NAME, ROUTING_KEY, QUEUE_NAME. Либо воспользуйтесь дефолтными найстройками для подключения к брокеру. Главное создайте файл, заполнять необязательно. 

3. Скачайте и устанвоите Docker

4. На ходясь в папке Fast_api_app, в консоле запустите docker-compose up --build

6. Подождите не много времени. Нужно время для продключения к брокеру

7. Запустите страницу с swagger  - http://127.0.0.1:8888/

8. RabbitMQ Management - http://127.0.0.1:15672/#/ guest/guest (если дефолт)


# Реализованные точки

- проект досутупен http://127.0.0.1:8888/ На странице вы увидете 2 ручки.

- POST/file/upload-bytes - отвечает за загрузку пользователем файла, формата txt. После этого, данные из файла попадают в брокер, а из брокера в базу данных.

- GET/message/{message_id} - Позволяет пользователю запросить данные из базы данных по id. (date, tittle, x_avg_count_in_line)

- Данные придут форматом:

```
{
  "id": 1,
  "date": "15.11.2023 15:00:25.001",
  "title": "Very fun book",
  "x_avg_count_in_line": 0.225
}

```
